	list p=16f690
	#include <p16f690.inc>
	radix dec
; Begin
	R0L EQU 0x20
	R0H EQU 0x21
	R1L EQU 0x22
	R1H EQU 0x23
	R2L EQU 0x24
	R2H EQU 0x25
	R3L EQU 0x26
	R3H EQU 0x27
	R4L EQU 0x28
	R4H EQU 0x29
	R5L EQU 0x2A
	R5H EQU 0x2B
	SO_PORT EQU 0x2C
	SO_BIT EQU 0x2D
	SO_INTL EQU 0x2E
	SO_INTH EQU 0x2F
	ORG 0x0000
	BCF PCLATH,3
	BCF PCLATH,4
	GOTO L0008
	ORG 0x0004
	RETFIE
; Multiplication Routine
M001:	MOVLW 0x10
	MOVWF R4L
	CLRF R0H
	CLRF R0L
M002:	RRF R3H,F
	RRF R3L,F
	BTFSS STATUS,C
	GOTO M003
	MOVF R1L,W
	ADDWF R0L,F
	MOVF R1H,W
	BTFSC STATUS,C
	INCFSZ R1H,W
	ADDWF R0H,F
M003:	RRF R0H,F
	RRF R0L,F
	RRF R2H,F
	RRF R2L,F
	DECFSZ R4L,F
	GOTO M002
	MOVF R2L,W
	RETURN
; Division Routine
D001:	MOVLW 0x10
	MOVWF R3L
	CLRF R2H
	CLRF R2L
D002:	RLF R0H,W
	RLF R2L,F
	RLF R2H,F
	MOVF R1L,W
	SUBWF R2L,F
	MOVF R1H,W
	BTFSS STATUS,C
	INCFSZ R1H,W
	SUBWF R2H,F
	BTFSC STATUS,C
	GOTO D003
	MOVF R1L,W
	ADDWF R2L,F
	MOVF R1H,W
	BTFSC STATUS,C
	INCFSZ R1H,W
	ADDWF R2H,F
	BCF STATUS,C
D003:	RLF R0L,F
	RLF R0H,F
	DECFSZ R3L,F
	GOTO D002
	MOVF R0L,W
	RETURN
; Comparison Routine
C001:	MOVWF R1L
	MOVLW 0x05
	GOTO C007
C002:	MOVWF R1L
	MOVLW 0x02
	GOTO C007
C003:	MOVWF R1L
	MOVLW 0x06
	GOTO C007
C004:	MOVWF R1L
	MOVLW 0x03
	GOTO C007
C005:	MOVWF R1L
	MOVLW 0x04
	GOTO C007
C006:	MOVWF R1L
	MOVLW 0x01
	GOTO C007
C007:	MOVWF R4L
	MOVF R1H,W
	SUBWF R0H,W
	BTFSS STATUS,Z
	GOTO C008
	MOVF R1L,W
	SUBWF R0L,W
C008:	MOVLW 0x04
	BTFSC STATUS,C
	MOVLW 0x01
	BTFSC STATUS,Z
	MOVLW 0x02
	ANDWF R4L,W
	BTFSS STATUS,Z
	MOVLW 0xFF
	RETURN
; Waitms Routine
W001:	MOVF R0L,F
	BTFSC STATUS,Z
	GOTO W002
	CALL W003
	DECF R0L,F
	NOP
	NOP
	NOP
	NOP
	NOP
	GOTO W001
W002:	MOVF R0H,F
	BTFSC STATUS,Z
	RETURN
	CALL W003
	DECF R0H,F
	DECF R0L,F
	GOTO W001
W003:	MOVLW 0x0C
	MOVWF R2H
W004:	DECFSZ R2H,F
	GOTO W004
	NOP
	NOP
	MOVLW 0x03
	MOVWF R1L
W005:	DECFSZ R1L,F
	GOTO W006
	CALL W007
	CALL W007
	NOP
	NOP
	RETURN
W006:	CALL W007
	GOTO W005
W007:	MOVLW 0x0D
	MOVWF R2L
W008:	DECFSZ R2L,F
	GOTO W008
	NOP
	RETURN
; Waitus Routine - Byte Argument
X001:	MOVLW 0x25
	SUBWF R4L,F
	BTFSS STATUS,C
	RETURN
	GOTO X002
X002:	MOVLW 0x18
	SUBWF R4L,F
	BTFSS STATUS,C
	RETURN
	GOTO X002
; Waitus Routine - Word Argument
Y001:	MOVLW 0x3D
	SUBWF R4L,F
	CLRW
	BTFSS STATUS,C
	ADDLW 0x01
	SUBWF R4H,F
	BTFSS STATUS,C
	RETURN
	GOTO Y002
Y002:	MOVLW 0x28
	SUBWF R4L,F
	CLRW
	BTFSS STATUS,C
	ADDLW 0x01
	SUBWF R4H,F
	BTFSS STATUS,C
	RETURN
	GOTO Y002
; Adcin Routine
A001:	RLF R0L,F
	RLF R0L,F
	MOVLW 0x3C
	ANDWF R0L,F
	MOVLW 0xC0
	ANDWF ADCON0,F
	MOVF R0L,W
	IORWF ADCON0,F
	BSF ADCON0,ADON
	MOVLW 0x14
	MOVWF R4L
	CALL X001
	BSF ADCON0,GO
A002:	BTFSC ADCON0,GO
	GOTO A002
	BCF PIR1,ADIF
	BCF ADCON0,ADON
	RETURN
; Serout Routine
SO01:	MOVWF R5L
	MOVLW 0xD0
	MOVWF R4L
	MOVLW 0x07
	MOVWF R4H
	CALL Y001
	MOVF SO_PORT,W
	MOVWF FSR
	MOVLW 0x09
	MOVWF R5H
	BCF STATUS,C
SO02:	CALL SO03
	RRF R5L,F
	DECFSZ R5H,F
	GOTO SO02
	BSF STATUS,C
	CALL SO03
	RETURN
SO03:	MOVF INDF,W
	IORWF SO_BIT,W
	BTFSS STATUS,C
	XORWF SO_BIT,W
	MOVWF INDF
	MOVF SO_INTL,W
	MOVWF R4L
	MOVF SO_INTH,W
	MOVWF R4H
	CALL Y001
	RETURN
; Begin of program
L0008:
; 1: Define CONF_WORD = 0x330c
; 2: 
; 3:  'HP-URPS Controller Firmware
; 4: Dim x As Byte
;       The address of 'x' is 0x33
	x EQU 0x33
; 5: Dim y As Byte
;       The address of 'y' is 0x34
	y EQU 0x34
; 6: Dim i As Byte
;       The address of 'i' is 0x35
	i EQU 0x35
; 7: Dim tim As Word
;       The address of 'tim' is 0x36
	tim EQU 0x36
; 8: Dim batvolts As Word
;       The address of 'batvolts' is 0x38
	batvolts EQU 0x38
; 9: Dim psu1volts As Word
;       The address of 'psu1volts' is 0x3A
	psu1volts EQU 0x3A
; 10: Dim psu2volts As Word
;       The address of 'psu2volts' is 0x3C
	psu2volts EQU 0x3C
; 11: Dim opvolts As Word
;       The address of 'opvolts' is 0x3E
	opvolts EQU 0x3E
; 12: Dim batov As Bit
;       The address of 'batov' is 0x30,0
; 13: Dim batuv As Bit
;       The address of 'batuv' is 0x30,1
; 14: Dim nobat As Bit
;       The address of 'nobat' is 0x30,2
; 15: Dim charge As Bit
;       The address of 'charge' is 0x30,3
; 16: Dim discharge As Bit
;       The address of 'discharge' is 0x30,4
; 17: Dim trickle As Bit
;       The address of 'trickle' is 0x30,5
; 18: Dim top_green As Bit
;       The address of 'top_green' is 0x30,6
; 19: Dim top_red As Bit
;       The address of 'top_red' is 0x30,7
; 20: Dim ctr_green As Bit
;       The address of 'ctr_green' is 0x31,0
; 21: Dim ctr_red As Bit
;       The address of 'ctr_red' is 0x31,1
; 22: Dim bot_green As Bit
;       The address of 'bot_green' is 0x31,2
; 23: Dim bot_red As Bit
;       The address of 'bot_red' is 0x31,3
; 24: Dim leds_blanked As Bit
;       The address of 'leds_blanked' is 0x31,4
; 25: Dim palarm1 As Bit 'psu alarm
;       The address of 'palarm1' is 0x31,5
; 26: Dim palarm2 As Bit 'psu alarm
;       The address of 'palarm2' is 0x31,6
; 27: Dim balarm As Bit 'Battery Alarm
;       The address of 'balarm' is 0x31,7
; 28: Dim alarm_on As Bit
;       The address of 'alarm_on' is 0x32,0
; 29: Dim al As Bit
;       The address of 'al' is 0x32,1
; 30: Dim alarm_byte As Byte
;       The address of 'alarm_byte' is 0x40
	alarm_byte EQU 0x40
; 31: Dim bov As Bit
;       The address of 'bov' is 0x32,2
; 32: Dim out_ctrl As Bit
;       The address of 'out_ctrl' is 0x32,3
; 33: Dim p1v As Word
;       The address of 'p1v' is 0x41
	p1v EQU 0x41
; 34: Dim p1vl As Byte
;       The address of 'p1vl' is 0x43
	p1vl EQU 0x43
; 35: Dim p2v As Word
;       The address of 'p2v' is 0x44
	p2v EQU 0x44
; 36: Dim p2vl As Byte
;       The address of 'p2vl' is 0x46
	p2vl EQU 0x46
; 37: Dim ov As Word
;       The address of 'ov' is 0x47
	ov EQU 0x47
; 38: Dim ovl As Byte
;       The address of 'ovl' is 0x49
	ovl EQU 0x49
; 39: Dim bv As Word
;       The address of 'bv' is 0x4A
	bv EQU 0x4A
; 40: Dim bvl As Byte
;       The address of 'bvl' is 0x4C
	bvl EQU 0x4C
; 41: Dim uv_psuv As Word
;       The address of 'uv_psuv' is 0x4D
	uv_psuv EQU 0x4D
; 42: Dim opalarm As Bit
;       The address of 'opalarm' is 0x32,4
; 43: Dim opv_ok As Bit
;       The address of 'opv_ok' is 0x32,5
; 44: Dim volts As Word
;       The address of 'volts' is 0x4F
	volts EQU 0x4F
; 45: Dim ignore As Bit
;       The address of 'ignore' is 0x32,6
; 46: Dim ae As Byte
;       The address of 'ae' is 0x51
	ae EQU 0x51
; 47: 
; 48:  'Voltage Constants x 68.33
; 49: Const ov_psu = 963 '14.1
;       The value of 'ov_psu' is 963
; 50: Const uv_psuadj = 950 '13.9
;       The value of 'uv_psuadj' is 950
; 51: Const uv_psurun = 915 '13.4
;       The value of 'uv_psurun' is 915
; 52: Const batt_ov = 965 '14.0V
;       The value of 'batt_ov' is 965
; 53: Const sw_out_off = 806 '11.8V
;       The value of 'sw_out_off' is 806
; 54: Const sw_out_on = 854 '12.5V
;       The value of 'sw_out_on' is 854
; 55: Const warn_batt = 750 '11.0V
;       The value of 'warn_batt' is 750
; 56: Const uv_batt = 683 '10.0V
;       The value of 'uv_batt' is 683
; 57: Const dead_batt = 341 '5.0V
;       The value of 'dead_batt' is 341
; 58: 
; 59: ADCON0 = %11011000
	MOVLW 0xD8
	MOVWF 0x1F
; 60: ADCON1 = %01000000
	BSF STATUS,RP0
	MOVLW 0x40
	MOVWF 0x1F
; 61: OSCCON = %01000001 'Internal Osc 1MHz No external signal ***Ensure compiler set to 1MHz
	MOVLW 0x41
	MOVWF 0x0F
; 62: ANSEL = %10001001
	BSF STATUS,RP1
	BCF STATUS,RP0
	MOVLW 0x89
	MOVWF 0x1E
; 63: ANSELH = %00001000
	MOVLW 0x08
	MOVWF 0x1F
; 64: TMR0 = 0
	BCF STATUS,RP1
	CLRF 0x01
; 65: OPTION_REG = %10001110
	BSF STATUS,RP0
	MOVLW 0x8E
	MOVWF 0x01
; 66: Define ADC_CLOCK = 3
; 67: Define SEROUT_DELAYUS = 2000
; 68:  'Define ADC_SAMPLEUS = 250
; 69: 
	BCF STATUS,RP0
; 70: ASM:        clrwdt
	       clrwdt
; 71: 
; 72:  'Define ports
; 73: TRISA.0 = 1 'Battery Voltage
	BSF STATUS,RP0
	BSF 0x05,0
; 74: TRISA.1 = 1 'ADC Reference input
	BSF 0x05,1
; 75: TRISA.2 = 0 'Switched output control
	BCF 0x05,2
; 76: TRISA.3 = 1 'Push button
	BSF 0x05,3
; 77: TRISA.4 = 1 'PSU1 Voltage
	BSF 0x05,4
; 78: TRISA.5 = 0 'LED1
	BCF 0x05,5
; 79: 
; 80: TRISB.4 = 0 'LED3
	BCF 0x06,4
; 81: TRISB.5 = 1 'Output voltage
	BSF 0x06,5
; 82: TRISB.6 = 0 'LED2
	BCF 0x06,6
; 83: TRISB.7 = 0 'Serial out
	BCF 0x06,7
; 84: 
; 85: TRISC.0 = 0 'LED3
	BCF 0x07,0
; 86: TRISC.1 = 0 'Buzzer control
	BCF 0x07,1
; 87: TRISC.2 = 0 'LED2
	BCF 0x07,2
; 88: TRISC.3 = 1 'PSU2 Voltage
	BSF 0x07,3
; 89: TRISC.4 = 0 'LED1
	BCF 0x07,4
; 90: TRISC.5 = 0 'Under-voltage control
	BCF 0x07,5
; 91: TRISC.6 = 0 'Trickle charge control
	BCF 0x07,6
; 92: TRISC.7 = 0 'Over-voltage switch control
	BCF 0x07,7
; 93: 
; 94:  'Initialise ports
; 95: PORTA.5 = 0
	BCF STATUS,RP0
	BCF 0x05,5
; 96: PORTA.5 = 0
	BCF 0x05,5
; 97: PORTB.4 = 0
	BCF 0x06,4
; 98: PORTB.6 = 0
	BCF 0x06,6
; 99: PORTB.7 = 0
	BCF 0x06,7
; 100: PORTC.0 = 0
	BCF 0x07,0
; 101: PORTC.1 = 0
	BCF 0x07,1
; 102: PORTC.2 = 0
	BCF 0x07,2
; 103: PORTC.4 = 0
	BCF 0x07,4
; 104: PORTC.5 = 0
	BCF 0x07,5
; 105: PORTC.6 = 0
	BCF 0x07,6
; 106: PORTC.7 = 0
	BCF 0x07,7
; 107: 
; 108:  'Initialise variables
; 109: charge = False
	BCF 0x30,3
; 110: discharge = False
	BCF 0x30,4
; 111: top_green = False
	BCF 0x30,6
; 112: top_red = False
	BCF 0x30,7
; 113: ctr_green = False
	BCF 0x31,0
; 114: ctr_red = False
	BCF 0x31,1
; 115: bot_green = False
	BCF 0x31,2
; 116: bot_red = False
	BCF 0x31,3
; 117: al = False
	BCF 0x32,1
; 118: alarm_on = True
	BSF 0x32,0
; 119: bov = False
	BCF 0x32,2
; 120: trickle = True
	BSF 0x30,5
; 121: out_ctrl = True
	BSF 0x32,3
; 122: tim = 1
	MOVLW 0x01
	MOVWF 0x36
	CLRF 0x37
; 123: balarm = False
	BCF 0x31,7
; 124: palarm1 = False
	BCF 0x31,5
; 125: palarm2 = False
	BCF 0x31,6
; 126: x = 0
	CLRF 0x33
; 127: y = 0
	CLRF 0x34
; 128: ignore = False
	BCF 0x32,6
; 129: ae = 0
	CLRF 0x51
; 130: 
; 131: Gosub led_test
	BSF PCLATH,3
	BCF PCLATH,4
	CALL L0007
; 132:  '__________________________________________________________
; 133: 
; 134: 
; 135:  '**********************************************************
; 136:  '__________________________________________________________
; 137: start:  'START OF MAIN LOOP
L0001:
; 138: 
; 139: Gosub control
	BSF PCLATH,3
	BCF PCLATH,4
	CALL L0005
; 140: ASM:        clrwdt
	       clrwdt
; 141:  'flash heart-beat LED every 64 times round loop
; 142: If leds_blanked = True And al = False And x = 0 Then
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS 0x31,4
	GOTO L0009
	MOVLW 0x1F
	ANDWF STATUS,F
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSC 0x32,1
	GOTO L0009
	MOVLW 0x1F
	ANDWF STATUS,F
	MOVF 0x33,W
	SUBLW 0x00
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0009
; 143: PORTB.6 = 1
	BSF 0x06,6
; 144: WaitMs 10
	MOVLW 0x0A
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 145: PORTB.6 = 0
	BCF 0x06,6
; 146: Else
	BCF PCLATH,3
	BCF PCLATH,4
	GOTO L0010
L0009:	MOVLW 0x1F
	ANDWF STATUS,F
; 147: If leds_blanked = True And al = True And x = 0 Then
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS 0x31,4
	GOTO L0011
	MOVLW 0x1F
	ANDWF STATUS,F
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS 0x32,1
	GOTO L0011
	MOVLW 0x1F
	ANDWF STATUS,F
	MOVF 0x33,W
	SUBLW 0x00
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0011
; 148: PORTC.2 = 1
	BSF 0x07,2
; 149: WaitMs 10
	MOVLW 0x0A
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 150: PORTC.2 = 0
	BCF 0x07,2
; 151: Endif
L0011:	MOVLW 0x1F
	ANDWF STATUS,F
; 152: Endif
L0010:	MOVLW 0x1F
	ANDWF STATUS,F
; 153: 
; 154:  'Create Serial data bytes and send them every 64 times around the loop
; 155: If x = 0 Then
	MOVF 0x33,W
	SUBLW 0x00
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0012
; 156: p1v = psu1volts * 8
	MOVF 0x3A,W
	MOVWF R3L
	MOVF 0x3B,W
	MOVWF R3H
	MOVLW 0x08
	MOVWF R1L
	CLRF R1H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL M001
	MOVWF 0x41
	MOVF R2H,W
	MOVWF 0x42
; 157: p1vl = p1v.LB / 8
	MOVF 0x41,W
	MOVWF R0L
	CLRF R0H
	MOVLW 0x08
	MOVWF R1L
	CLRF R1H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL D001
	MOVWF 0x43
; 158: 
; 159: p2v = psu2volts * 8
	MOVF 0x3C,W
	MOVWF R3L
	MOVF 0x3D,W
	MOVWF R3H
	MOVLW 0x08
	MOVWF R1L
	CLRF R1H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL M001
	MOVWF 0x44
	MOVF R2H,W
	MOVWF 0x45
; 160: p2vl = p2v.LB / 8
	MOVF 0x44,W
	MOVWF R0L
	CLRF R0H
	MOVLW 0x08
	MOVWF R1L
	CLRF R1H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL D001
	MOVWF 0x46
; 161: 
; 162: bv = batvolts * 8
	MOVF 0x38,W
	MOVWF R3L
	MOVF 0x39,W
	MOVWF R3H
	MOVLW 0x08
	MOVWF R1L
	CLRF R1H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL M001
	MOVWF 0x4A
	MOVF R2H,W
	MOVWF 0x4B
; 163: bvl = bv.LB / 8
	MOVF 0x4A,W
	MOVWF R0L
	CLRF R0H
	MOVLW 0x08
	MOVWF R1L
	CLRF R1H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL D001
	MOVWF 0x4C
; 164: 
; 165: ov = opvolts * 8
	MOVF 0x3E,W
	MOVWF R3L
	MOVF 0x3F,W
	MOVWF R3H
	MOVLW 0x08
	MOVWF R1L
	CLRF R1H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL M001
	MOVWF 0x47
	MOVF R2H,W
	MOVWF 0x48
; 166: ovl = ov.LB / 8
	MOVF 0x47,W
	MOVWF R0L
	CLRF R0H
	MOVLW 0x08
	MOVWF R1L
	CLRF R1H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL D001
	MOVWF 0x49
; 167: 
; 168:  'Start byte 0xFF
; 169:  'all data words shifted so high and low bytes each contain 5 bits both right justified
; 170: Serout PORTB.7, 2400, 0xff, p1v.HB, p1vl, p2v.HB, p2vl, bv.HB, bvl, ov.HB, ovl, alarm_byte
	BSF STATUS,RP0
	BCF TRISB,7
	BCF STATUS,RP0
	BSF PORTB,7
	MOVLW 0x06
	MOVWF SO_PORT
	MOVLW 0x80
	MOVWF SO_BIT
	MOVLW 0x6C
	MOVWF SO_INTL
	MOVLW 0x01
	MOVWF SO_INTH
	BCF PCLATH,3
	BCF PCLATH,4
	MOVLW 0xFF
	CALL SO01
	MOVF 0x42,W
	CALL SO01
	MOVF 0x43,W
	CALL SO01
	MOVF 0x45,W
	CALL SO01
	MOVF 0x46,W
	CALL SO01
	MOVF 0x4B,W
	CALL SO01
	MOVF 0x4C,W
	CALL SO01
	MOVF 0x48,W
	CALL SO01
	MOVF 0x49,W
	CALL SO01
	MOVF 0x40,W
	CALL SO01
; 171: 
; 172: Endif
L0012:	MOVLW 0x1F
	ANDWF STATUS,F
; 173: 
; 174: If x < 63 Then
	MOVLW 0x3F
	SUBWF 0x33,W
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSC STATUS,C
	GOTO L0013
; 175: x = x + 1
	MOVF 0x33,W
	ADDLW 0x01
	MOVWF 0x33
; 176: Else
	BCF PCLATH,3
	BCF PCLATH,4
	GOTO L0014
L0013:	MOVLW 0x1F
	ANDWF STATUS,F
; 177: x = 0
	CLRF 0x33
; 178: Endif
L0014:	MOVLW 0x1F
	ANDWF STATUS,F
; 179: 
; 180: Gosub time_on
	BSF PCLATH,3
	BCF PCLATH,4
	CALL L0006
; 181: ASM:        clrwdt
	       clrwdt
; 182: 
; 183: volts = 0
	CLRF 0x4F
	CLRF 0x50
; 184: Adcin 3, psu2volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x03
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3C
	MOVF ADRESH,W
	MOVWF 0x3D
; 185: volts = volts + psu2volts
	MOVF 0x4F,W
	ADDWF 0x3C,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3D,W
	MOVWF 0x50
; 186: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 187: Adcin 3, psu2volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x03
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3C
	MOVF ADRESH,W
	MOVWF 0x3D
; 188: volts = volts + psu2volts
	MOVF 0x4F,W
	ADDWF 0x3C,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3D,W
	MOVWF 0x50
; 189: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 190: Adcin 3, psu2volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x03
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3C
	MOVF ADRESH,W
	MOVWF 0x3D
; 191: volts = volts + psu2volts
	MOVF 0x4F,W
	ADDWF 0x3C,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3D,W
	MOVWF 0x50
; 192: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 193: Adcin 3, psu2volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x03
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3C
	MOVF ADRESH,W
	MOVWF 0x3D
; 194: volts = volts + psu2volts
	MOVF 0x4F,W
	ADDWF 0x3C,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3D,W
	MOVWF 0x50
; 195: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 196: Adcin 3, psu2volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x03
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3C
	MOVF ADRESH,W
	MOVWF 0x3D
; 197: volts = volts + psu2volts
	MOVF 0x4F,W
	ADDWF 0x3C,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3D,W
	MOVWF 0x50
; 198: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 199: Adcin 3, psu2volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x03
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3C
	MOVF ADRESH,W
	MOVWF 0x3D
; 200: volts = volts + psu2volts
	MOVF 0x4F,W
	ADDWF 0x3C,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3D,W
	MOVWF 0x50
; 201: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 202: Adcin 3, psu2volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x03
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3C
	MOVF ADRESH,W
	MOVWF 0x3D
; 203: volts = volts + psu2volts
	MOVF 0x4F,W
	ADDWF 0x3C,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3D,W
	MOVWF 0x50
; 204: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 205: Adcin 3, psu2volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x03
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3C
	MOVF ADRESH,W
	MOVWF 0x3D
; 206: volts = volts + psu2volts
	MOVF 0x4F,W
	ADDWF 0x3C,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3D,W
	MOVWF 0x50
; 207: psu2volts = volts / 8 'Take 8 readings and average them
	MOVF 0x4F,W
	MOVWF R0L
	MOVF 0x50,W
	MOVWF R0H
	MOVLW 0x08
	MOVWF R1L
	CLRF R1H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL D001
	MOVWF 0x3C
	MOVF R0H,W
	MOVWF 0x3D
; 208: 
; 209: volts = 0
	CLRF 0x4F
	CLRF 0x50
; 210: Adcin 7, psu1volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x07
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3A
	MOVF ADRESH,W
	MOVWF 0x3B
; 211: volts = volts + psu1volts
	MOVF 0x4F,W
	ADDWF 0x3A,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3B,W
	MOVWF 0x50
; 212: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 213: Adcin 7, psu1volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x07
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3A
	MOVF ADRESH,W
	MOVWF 0x3B
; 214: volts = volts + psu1volts
	MOVF 0x4F,W
	ADDWF 0x3A,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3B,W
	MOVWF 0x50
; 215: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 216: Adcin 7, psu1volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x07
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3A
	MOVF ADRESH,W
	MOVWF 0x3B
; 217: volts = volts + psu1volts
	MOVF 0x4F,W
	ADDWF 0x3A,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3B,W
	MOVWF 0x50
; 218: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 219: Adcin 7, psu1volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x07
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3A
	MOVF ADRESH,W
	MOVWF 0x3B
; 220: volts = volts + psu1volts
	MOVF 0x4F,W
	ADDWF 0x3A,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3B,W
	MOVWF 0x50
; 221: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 222: Adcin 7, psu1volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x07
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3A
	MOVF ADRESH,W
	MOVWF 0x3B
; 223: volts = volts + psu1volts
	MOVF 0x4F,W
	ADDWF 0x3A,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3B,W
	MOVWF 0x50
; 224: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 225: Adcin 7, psu1volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x07
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3A
	MOVF ADRESH,W
	MOVWF 0x3B
; 226: volts = volts + psu1volts
	MOVF 0x4F,W
	ADDWF 0x3A,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3B,W
	MOVWF 0x50
; 227: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 228: Adcin 7, psu1volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x07
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3A
	MOVF ADRESH,W
	MOVWF 0x3B
; 229: volts = volts + psu1volts
	MOVF 0x4F,W
	ADDWF 0x3A,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3B,W
	MOVWF 0x50
; 230: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 231: Adcin 7, psu1volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x07
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3A
	MOVF ADRESH,W
	MOVWF 0x3B
; 232: volts = volts + psu1volts
	MOVF 0x4F,W
	ADDWF 0x3A,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3B,W
	MOVWF 0x50
; 233: psu1volts = volts / 8 'Take 8 readings and average them
	MOVF 0x4F,W
	MOVWF R0L
	MOVF 0x50,W
	MOVWF R0H
	MOVLW 0x08
	MOVWF R1L
	CLRF R1H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL D001
	MOVWF 0x3A
	MOVF R0H,W
	MOVWF 0x3B
; 234: 
; 235: Adcin 2, opvolts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x02
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3E
	MOVF ADRESH,W
	MOVWF 0x3F
; 236: 
; 237: ASM:        clrwdt
	       clrwdt
; 238:  'PSU adjustment routine
; 239: If PORTA.3 = 0 Then
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSC 0x05,3
	GOTO L0015
; 240: 
; 241: Gosub time_on
	BSF PCLATH,3
	BCF PCLATH,4
	CALL L0006
; 242: 
; 243: uv_psuv = uv_psuadj
	MOVLW 0xB6
	MOVWF 0x4D
	MOVLW 0x03
	MOVWF 0x4E
; 244: 
; 245: adjustpsus: 
L0002:
; 246: volts = 0
	CLRF 0x4F
	CLRF 0x50
; 247: Adcin 3, psu2volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x03
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3C
	MOVF ADRESH,W
	MOVWF 0x3D
; 248: volts = volts + psu2volts
	MOVF 0x4F,W
	ADDWF 0x3C,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3D,W
	MOVWF 0x50
; 249: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 250: Adcin 3, psu2volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x03
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3C
	MOVF ADRESH,W
	MOVWF 0x3D
; 251: volts = volts + psu2volts
	MOVF 0x4F,W
	ADDWF 0x3C,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3D,W
	MOVWF 0x50
; 252: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 253: Adcin 3, psu2volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x03
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3C
	MOVF ADRESH,W
	MOVWF 0x3D
; 254: volts = volts + psu2volts
	MOVF 0x4F,W
	ADDWF 0x3C,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3D,W
	MOVWF 0x50
; 255: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 256: Adcin 3, psu2volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x03
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3C
	MOVF ADRESH,W
	MOVWF 0x3D
; 257: volts = volts + psu2volts
	MOVF 0x4F,W
	ADDWF 0x3C,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3D,W
	MOVWF 0x50
; 258: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 259: Adcin 3, psu2volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x03
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3C
	MOVF ADRESH,W
	MOVWF 0x3D
; 260: volts = volts + psu2volts
	MOVF 0x4F,W
	ADDWF 0x3C,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3D,W
	MOVWF 0x50
; 261: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 262: Adcin 3, psu2volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x03
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3C
	MOVF ADRESH,W
	MOVWF 0x3D
; 263: volts = volts + psu2volts
	MOVF 0x4F,W
	ADDWF 0x3C,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3D,W
	MOVWF 0x50
; 264: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 265: Adcin 3, psu2volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x03
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3C
	MOVF ADRESH,W
	MOVWF 0x3D
; 266: volts = volts + psu2volts
	MOVF 0x4F,W
	ADDWF 0x3C,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3D,W
	MOVWF 0x50
; 267: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 268: Adcin 3, psu2volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x03
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3C
	MOVF ADRESH,W
	MOVWF 0x3D
; 269: volts = volts + psu2volts
	MOVF 0x4F,W
	ADDWF 0x3C,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3D,W
	MOVWF 0x50
; 270: psu2volts = volts / 8 'Take 8 readings and average them
	MOVF 0x4F,W
	MOVWF R0L
	MOVF 0x50,W
	MOVWF R0H
	MOVLW 0x08
	MOVWF R1L
	CLRF R1H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL D001
	MOVWF 0x3C
	MOVF R0H,W
	MOVWF 0x3D
; 271: 
; 272: volts = 0
	CLRF 0x4F
	CLRF 0x50
; 273: Adcin 7, psu1volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x07
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3A
	MOVF ADRESH,W
	MOVWF 0x3B
; 274: volts = volts + psu1volts
	MOVF 0x4F,W
	ADDWF 0x3A,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3B,W
	MOVWF 0x50
; 275: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 276: Adcin 7, psu1volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x07
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3A
	MOVF ADRESH,W
	MOVWF 0x3B
; 277: volts = volts + psu1volts
	MOVF 0x4F,W
	ADDWF 0x3A,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3B,W
	MOVWF 0x50
; 278: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 279: Adcin 7, psu1volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x07
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3A
	MOVF ADRESH,W
	MOVWF 0x3B
; 280: volts = volts + psu1volts
	MOVF 0x4F,W
	ADDWF 0x3A,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3B,W
	MOVWF 0x50
; 281: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 282: Adcin 7, psu1volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x07
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3A
	MOVF ADRESH,W
	MOVWF 0x3B
; 283: volts = volts + psu1volts
	MOVF 0x4F,W
	ADDWF 0x3A,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3B,W
	MOVWF 0x50
; 284: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 285: Adcin 7, psu1volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x07
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3A
	MOVF ADRESH,W
	MOVWF 0x3B
; 286: volts = volts + psu1volts
	MOVF 0x4F,W
	ADDWF 0x3A,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3B,W
	MOVWF 0x50
; 287: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 288: Adcin 7, psu1volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x07
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3A
	MOVF ADRESH,W
	MOVWF 0x3B
; 289: volts = volts + psu1volts
	MOVF 0x4F,W
	ADDWF 0x3A,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3B,W
	MOVWF 0x50
; 290: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 291: Adcin 7, psu1volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x07
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3A
	MOVF ADRESH,W
	MOVWF 0x3B
; 292: volts = volts + psu1volts
	MOVF 0x4F,W
	ADDWF 0x3A,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3B,W
	MOVWF 0x50
; 293: WaitMs 1
	MOVLW 0x01
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 294: Adcin 7, psu1volts
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x07
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x3A
	MOVF ADRESH,W
	MOVWF 0x3B
; 295: volts = volts + psu1volts
	MOVF 0x4F,W
	ADDWF 0x3A,W
	MOVWF 0x4F
	MOVF 0x50,W
	BTFSC STATUS,C
	ADDLW 0x01
	ADDWF 0x3B,W
	MOVWF 0x50
; 296: psu1volts = volts / 8 'Take 8 readings and average them
	MOVF 0x4F,W
	MOVWF R0L
	MOVF 0x50,W
	MOVWF R0H
	MOVLW 0x08
	MOVWF R1L
	CLRF R1H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL D001
	MOVWF 0x3A
	MOVF R0H,W
	MOVWF 0x3B
; 297: If psu1volts > ov_psu Then 'Over Voltage
	MOVF 0x3A,W
	MOVWF R0L
	MOVF 0x3B,W
	MOVWF R0H
	MOVLW 0x03
	MOVWF R1H
	MOVLW 0xC3
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C003
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0016
; 298: top_green = True
	BSF 0x30,6
; 299: top_red = True
	BSF 0x30,7
; 300: Endif
L0016:	MOVLW 0x1F
	ANDWF STATUS,F
; 301: If psu1volts < ov_psu And psu1volts > uv_psuv Then 'Voltage OK
	MOVF 0x3A,W
	MOVWF R0L
	MOVF 0x3B,W
	MOVWF R0H
	MOVLW 0x03
	MOVWF R1H
	MOVLW 0xC3
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C004
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0017
	MOVLW 0x1F
	ANDWF STATUS,F
	MOVF 0x3A,W
	MOVWF R0L
	MOVF 0x3B,W
	MOVWF R0H
	MOVF 0x4E,W
	MOVWF R1H
	MOVF 0x4D,W
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C003
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0017
; 302: top_green = True
	BSF 0x30,6
; 303: top_red = False
	BCF 0x30,7
; 304: Endif
L0017:	MOVLW 0x1F
	ANDWF STATUS,F
; 305: If psu1volts < uv_psuv Then 'Under voltage
	MOVF 0x3A,W
	MOVWF R0L
	MOVF 0x3B,W
	MOVWF R0H
	MOVF 0x4E,W
	MOVWF R1H
	MOVF 0x4D,W
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C004
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0018
; 306: top_green = False
	BCF 0x30,6
; 307: top_red = True
	BSF 0x30,7
; 308: Endif
L0018:	MOVLW 0x1F
	ANDWF STATUS,F
; 309: If psu2volts > ov_psu Then 'Over Voltage
	MOVF 0x3C,W
	MOVWF R0L
	MOVF 0x3D,W
	MOVWF R0H
	MOVLW 0x03
	MOVWF R1H
	MOVLW 0xC3
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C003
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0019
; 310: ctr_green = True
	BSF 0x31,0
; 311: ctr_red = True
	BSF 0x31,1
; 312: Endif
L0019:	MOVLW 0x1F
	ANDWF STATUS,F
; 313: If psu2volts < ov_psu And psu2volts > uv_psuv Then 'Voltage OK
	MOVF 0x3C,W
	MOVWF R0L
	MOVF 0x3D,W
	MOVWF R0H
	MOVLW 0x03
	MOVWF R1H
	MOVLW 0xC3
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C004
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0020
	MOVLW 0x1F
	ANDWF STATUS,F
	MOVF 0x3C,W
	MOVWF R0L
	MOVF 0x3D,W
	MOVWF R0H
	MOVF 0x4E,W
	MOVWF R1H
	MOVF 0x4D,W
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C003
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0020
; 314: ctr_green = True
	BSF 0x31,0
; 315: ctr_red = False
	BCF 0x31,1
; 316: Endif
L0020:	MOVLW 0x1F
	ANDWF STATUS,F
; 317: If psu2volts < uv_psuv Then 'Under voltage
	MOVF 0x3C,W
	MOVWF R0L
	MOVF 0x3D,W
	MOVWF R0H
	MOVF 0x4E,W
	MOVWF R1H
	MOVF 0x4D,W
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C004
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0021
; 318: ctr_green = False
	BCF 0x31,0
; 319: ctr_red = True
	BSF 0x31,1
; 320: Endif
L0021:	MOVLW 0x1F
	ANDWF STATUS,F
; 321: Gosub display
	BSF PCLATH,3
	BCF PCLATH,4
	CALL L0004
; 322: ASM:        clrwdt
	       clrwdt
; 323: If PORTA.3 = 0 Then
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSC 0x05,3
	GOTO L0022
; 324: Goto adjustpsus
	BCF PCLATH,3
	BCF PCLATH,4
	GOTO L0002
; 325: Else
	BCF PCLATH,3
	BCF PCLATH,4
	GOTO L0023
L0022:	MOVLW 0x1F
	ANDWF STATUS,F
; 326: uv_psuv = uv_psurun
	MOVLW 0x93
	MOVWF 0x4D
	MOVLW 0x03
	MOVWF 0x4E
; 327: WaitMs 50
	MOVLW 0x32
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 328: Endif
L0023:	MOVLW 0x1F
	ANDWF STATUS,F
; 329: Endif
L0015:	MOVLW 0x1F
	ANDWF STATUS,F
; 330:  '------------------------------------------
; 331:  'Mains PSU monitor  - 1
; 332: If psu1volts > ov_psu Then 'Over Voltage
	MOVF 0x3A,W
	MOVWF R0L
	MOVF 0x3B,W
	MOVWF R0H
	MOVLW 0x03
	MOVWF R1H
	MOVLW 0xC3
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C003
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0024
; 333: top_green = True
	BSF 0x30,6
; 334: top_red = True
	BSF 0x30,7
; 335: Endif
L0024:	MOVLW 0x1F
	ANDWF STATUS,F
; 336: 
; 337: If psu1volts < ov_psu And psu1volts > uv_psuv Then 'Voltage OK
	MOVF 0x3A,W
	MOVWF R0L
	MOVF 0x3B,W
	MOVWF R0H
	MOVLW 0x03
	MOVWF R1H
	MOVLW 0xC3
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C004
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0025
	MOVLW 0x1F
	ANDWF STATUS,F
	MOVF 0x3A,W
	MOVWF R0L
	MOVF 0x3B,W
	MOVWF R0H
	MOVF 0x4E,W
	MOVWF R1H
	MOVF 0x4D,W
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C003
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0025
; 338: top_green = True
	BSF 0x30,6
; 339: top_red = False
	BCF 0x30,7
; 340: If palarm1 = True Then alarm_on = True
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS 0x31,5
	GOTO L0026
	BSF 0x32,0
L0026:	MOVLW 0x1F
	ANDWF STATUS,F
; 341: palarm1 = False
	BCF 0x31,5
; 342: Endif
L0025:	MOVLW 0x1F
	ANDWF STATUS,F
; 343: 
; 344: If psu1volts < uv_psuv Then 'Under voltage
	MOVF 0x3A,W
	MOVWF R0L
	MOVF 0x3B,W
	MOVWF R0H
	MOVF 0x4E,W
	MOVWF R1H
	MOVF 0x4D,W
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C004
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0027
; 345: top_green = False
	BCF 0x30,6
; 346: top_red = True
	BSF 0x30,7
; 347: palarm1 = True
	BSF 0x31,5
; 348: Endif
L0027:	MOVLW 0x1F
	ANDWF STATUS,F
; 349: 
; 350:  '------------------------------------------
; 351:  'Mains PSU monitor  - 2
; 352: If psu2volts > ov_psu Then 'Over Voltage
	MOVF 0x3C,W
	MOVWF R0L
	MOVF 0x3D,W
	MOVWF R0H
	MOVLW 0x03
	MOVWF R1H
	MOVLW 0xC3
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C003
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0028
; 353: ctr_green = True
	BSF 0x31,0
; 354: ctr_red = True
	BSF 0x31,1
; 355: Endif
L0028:	MOVLW 0x1F
	ANDWF STATUS,F
; 356: 
; 357: If psu2volts < ov_psu And psu2volts > uv_psuv Then 'Voltage OK
	MOVF 0x3C,W
	MOVWF R0L
	MOVF 0x3D,W
	MOVWF R0H
	MOVLW 0x03
	MOVWF R1H
	MOVLW 0xC3
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C004
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0029
	MOVLW 0x1F
	ANDWF STATUS,F
	MOVF 0x3C,W
	MOVWF R0L
	MOVF 0x3D,W
	MOVWF R0H
	MOVF 0x4E,W
	MOVWF R1H
	MOVF 0x4D,W
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C003
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0029
; 358: ctr_green = True
	BSF 0x31,0
; 359: ctr_red = False
	BCF 0x31,1
; 360: If palarm2 = True Then alarm_on = True
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS 0x31,6
	GOTO L0030
	BSF 0x32,0
L0030:	MOVLW 0x1F
	ANDWF STATUS,F
; 361: palarm2 = False
	BCF 0x31,6
; 362: Endif
L0029:	MOVLW 0x1F
	ANDWF STATUS,F
; 363: 
; 364: If psu2volts < uv_psuv Then 'Under voltage
	MOVF 0x3C,W
	MOVWF R0L
	MOVF 0x3D,W
	MOVWF R0H
	MOVF 0x4E,W
	MOVWF R1H
	MOVF 0x4D,W
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C004
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0031
; 365: ctr_green = False
	BCF 0x31,0
; 366: ctr_red = True
	BSF 0x31,1
; 367: palarm2 = True
	BSF 0x31,6
; 368: Endif
L0031:	MOVLW 0x1F
	ANDWF STATUS,F
; 369: 
; 370:  '---------------
; 371:  'Battery monitor
; 372: 
; 373: Gosub check_bat_present
	BSF PCLATH,3
	BCF PCLATH,4
	CALL L0003
; 374: If nobat = True Then
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS 0x30,2
	GOTO L0032
; 375: balarm = True
	BSF 0x31,7
; 376: Goto start
	BCF PCLATH,3
	BCF PCLATH,4
	GOTO L0001
; 377: Endif
L0032:	MOVLW 0x1F
	ANDWF STATUS,F
; 378: 
; 379: For i = 0 To 9
	CLRF 0x35
L0033:
	MOVF 0x35,W
	SUBLW 0x09
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,C
	GOTO L0034
; 380: 
; 381: ASM:        clrwdt
	       clrwdt
; 382: Gosub time_on
	BSF PCLATH,3
	BCF PCLATH,4
	CALL L0006
; 383: 
; 384: If batvolts > ov_psu Then 'Over Voltage > at battery
	MOVF 0x38,W
	MOVWF R0L
	MOVF 0x39,W
	MOVWF R0H
	MOVLW 0x03
	MOVWF R1H
	MOVLW 0xC3
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C003
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0035
; 385: bot_green = True
	BSF 0x31,2
; 386: bot_red = True
	BSF 0x31,3
; 387: charge = False
	BCF 0x30,3
; 388: trickle = False
	BCF 0x30,5
; 389: Endif
L0035:	MOVLW 0x1F
	ANDWF STATUS,F
; 390: 
; 391: If batvolts < ov_psu And batvolts > warn_batt Then 'Voltage OK between 11V and 14V
	MOVF 0x38,W
	MOVWF R0L
	MOVF 0x39,W
	MOVWF R0H
	MOVLW 0x03
	MOVWF R1H
	MOVLW 0xC3
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C004
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0036
	MOVLW 0x1F
	ANDWF STATUS,F
	MOVF 0x38,W
	MOVWF R0L
	MOVF 0x39,W
	MOVWF R0H
	MOVLW 0x02
	MOVWF R1H
	MOVLW 0xEE
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C003
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0036
; 392: bot_green = True
	BSF 0x31,2
; 393: bot_red = False
	BCF 0x31,3
; 394: discharge = True
	BSF 0x30,4
; 395: out_ctrl = True
	BSF 0x32,3
; 396: If balarm = True Then
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS 0x31,7
	GOTO L0037
; 397: alarm_on = True
	BSF 0x32,0
; 398: balarm = False
	BCF 0x31,7
; 399: Endif
L0037:	MOVLW 0x1F
	ANDWF STATUS,F
; 400: Endif
L0036:	MOVLW 0x1F
	ANDWF STATUS,F
; 401: 
; 402: If batvolts < ov_psu And batvolts > uv_batt Then
	MOVF 0x38,W
	MOVWF R0L
	MOVF 0x39,W
	MOVWF R0H
	MOVLW 0x03
	MOVWF R1H
	MOVLW 0xC3
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C004
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0038
	MOVLW 0x1F
	ANDWF STATUS,F
	MOVF 0x38,W
	MOVWF R0L
	MOVF 0x39,W
	MOVWF R0H
	MOVLW 0x02
	MOVWF R1H
	MOVLW 0xAB
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C003
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0038
; 403: trickle = True
	BSF 0x30,5
; 404: charge = True
	BSF 0x30,3
; 405: Endif
L0038:	MOVLW 0x1F
	ANDWF STATUS,F
; 406: 
; 407: If batvolts < sw_out_off Then 'Under voltage <11.8V
	MOVF 0x38,W
	MOVWF R0L
	MOVF 0x39,W
	MOVWF R0H
	MOVLW 0x03
	MOVWF R1H
	MOVLW 0x26
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C004
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0039
; 408: out_ctrl = False
	BCF 0x32,3
; 409: Endif
L0039:	MOVLW 0x1F
	ANDWF STATUS,F
; 410: 
; 411: If ctr_green = True Or top_green = True Then 'Mains power restored from either PSU
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS 0x31,0
	GOTO L0042
	BCF PCLATH,3
	BCF PCLATH,4
	GOTO L0041
L0042:
	MOVLW 0x1F
	ANDWF STATUS,F
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS 0x30,6
	GOTO L0040
L0041:
; 412: out_ctrl = True
	BSF 0x32,3
; 413: Endif
L0040:	MOVLW 0x1F
	ANDWF STATUS,F
; 414: 
; 415: If batvolts < warn_batt Then 'Under voltage <11V
	MOVF 0x38,W
	MOVWF R0L
	MOVF 0x39,W
	MOVWF R0H
	MOVLW 0x02
	MOVWF R1H
	MOVLW 0xEE
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C004
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0043
; 416: balarm = True
	BSF 0x31,7
; 417: Endif
L0043:	MOVLW 0x1F
	ANDWF STATUS,F
; 418: 
; 419: If batvolts < uv_batt Then 'Under voltage <10V
	MOVF 0x38,W
	MOVWF R0L
	MOVF 0x39,W
	MOVWF R0H
	MOVLW 0x02
	MOVWF R1H
	MOVLW 0xAB
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C004
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0044
; 420: charge = False
	BCF 0x30,3
; 421: discharge = False
	BCF 0x30,4
; 422: bot_green = False
	BCF 0x31,2
; 423: bot_red = True
	BSF 0x31,3
; 424: trickle = True
	BSF 0x30,5
; 425: Endif
L0044:	MOVLW 0x1F
	ANDWF STATUS,F
; 426: 
; 427: Next i
	MOVLW 0x01
	ADDWF 0x35,F
	BCF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,C
	GOTO L0033
L0034:	MOVLW 0x1F
	ANDWF STATUS,F
; 428: Goto start
	BCF PCLATH,3
	BCF PCLATH,4
	GOTO L0001
; 429: End
	BSF PCLATH,3
	BCF PCLATH,4
L0045:	GOTO L0045
; 430:  'Check if a battery is connected or is dead
; 431: 
; 432: check_bat_present: 
L0003:
; 433: 
; 434:  'Turn off charging circuit to isolate the battery input
; 435: PORTC.6 = 0 'Trickle off
	BCF 0x07,6
; 436: PORTC.7 = 0 'Charge off
	BCF 0x07,7
; 437: ASM:        clrwdt
	       clrwdt
; 438: WaitMs 3
	MOVLW 0x03
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 439: ASM:        clrwdt
	       clrwdt
; 440: 
; 441: Adcin 0, batvolts 'Measure battery voltage
	BSF ADCON0,ADFM
	BSF STATUS,RP0
	MOVLW 0x30
	MOVWF ADCON1
	MOVLW 0x00
	BCF STATUS,RP0
	MOVWF R0L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL A001
	BSF STATUS,RP0
	MOVF ADRESL,W
	BCF STATUS,RP0
	MOVWF 0x38
	MOVF ADRESH,W
	MOVWF 0x39
; 442: If batvolts < dead_batt Then 'if battery <5V turn off the battery circuit
	MOVF 0x38,W
	MOVWF R0L
	MOVF 0x39,W
	MOVWF R0H
	MOVLW 0x01
	MOVWF R1H
	MOVLW 0x55
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C004
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0046
; 443: nobat = True
	BSF 0x30,2
; 444: charge = False
	BCF 0x30,3
; 445: trickle = False
	BCF 0x30,5
; 446: bot_green = False
	BCF 0x31,2
; 447: bot_red = True
	BSF 0x31,3
; 448: balarm = True
	BSF 0x31,7
; 449: Else
	BSF PCLATH,3
	BCF PCLATH,4
	GOTO L0047
L0046:	MOVLW 0x1F
	ANDWF STATUS,F
; 450: nobat = False
	BCF 0x30,2
; 451: Endif
L0047:	MOVLW 0x1F
	ANDWF STATUS,F
; 452: Gosub control
	BSF PCLATH,3
	BCF PCLATH,4
	CALL L0005
; 453: WaitUs 100
	MOVLW 0x64
	MOVWF R4L
	BCF PCLATH,3
	BCF PCLATH,4
	CALL X001
; 454: Return
	RETURN
; 455: 
; 456: display:  'Decide which LEDS are on
L0004:
; 457: 
; 458: If leds_blanked = True Then
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS 0x31,4
	GOTO L0048
; 459: PORTA.5 = 0
	BCF 0x05,5
; 460: PORTC.4 = 0
	BCF 0x07,4
; 461: PORTB.6 = 0
	BCF 0x06,6
; 462: PORTC.2 = 0
	BCF 0x07,2
; 463: PORTB.4 = 0
	BCF 0x06,4
; 464: PORTC.0 = 0
	BCF 0x07,0
; 465: Else
	BSF PCLATH,3
	BCF PCLATH,4
	GOTO L0049
L0048:	MOVLW 0x1F
	ANDWF STATUS,F
; 466: PORTB.6 = top_green
	BTFSC 0x30,6
	BSF 0x06,6
	BTFSS 0x30,6
	BCF 0x06,6
; 467: PORTC.2 = top_red
	BTFSC 0x30,7
	BSF 0x07,2
	BTFSS 0x30,7
	BCF 0x07,2
; 468: PORTC.4 = ctr_green
	BTFSC 0x31,0
	BSF 0x07,4
	BTFSS 0x31,0
	BCF 0x07,4
; 469: PORTA.5 = ctr_red
	BTFSC 0x31,1
	BSF 0x05,5
	BTFSS 0x31,1
	BCF 0x05,5
; 470: PORTC.0 = bot_green
	BTFSC 0x31,2
	BSF 0x07,0
	BTFSS 0x31,2
	BCF 0x07,0
; 471: PORTB.4 = bot_red
	BTFSC 0x31,3
	BSF 0x06,4
	BTFSS 0x31,3
	BCF 0x06,4
; 472: Endif
L0049:	MOVLW 0x1F
	ANDWF STATUS,F
; 473: Return
	RETURN
; 474: 
; 475: control:  'Output the controls to MOSFETs and Buzzer
L0005:
; 476: 
; 477: PORTC.7 = charge
	BTFSC 0x30,3
	BSF 0x07,7
	BTFSS 0x30,3
	BCF 0x07,7
; 478: PORTC.5 = discharge
	BTFSC 0x30,4
	BSF 0x07,5
	BTFSS 0x30,4
	BCF 0x07,5
; 479: PORTC.6 = trickle
	BTFSC 0x30,5
	BSF 0x07,6
	BTFSS 0x30,5
	BCF 0x07,6
; 480: PORTA.2 = out_ctrl
	BTFSC 0x32,3
	BSF 0x05,2
	BTFSS 0x32,3
	BCF 0x05,2
; 481: Gosub display
	BSF PCLATH,3
	BCF PCLATH,4
	CALL L0004
; 482: 
; 483: al = False
	BCF 0x32,1
; 484: al = palarm1 Or palarm2
	CLRW
	BTFSC 0x31,5
	ADDLW 0x01
	BTFSC 0x31,6
	IORLW 0x01
	BTFSC STATUS,Z
	BCF 0x32,1
	BTFSS STATUS,Z
	BSF 0x32,1
; 485: al = al Or balarm
	CLRW
	BTFSC 0x32,1
	ADDLW 0x01
	BTFSC 0x31,7
	IORLW 0x01
	BTFSC STATUS,Z
	BCF 0x32,1
	BTFSS STATUS,Z
	BSF 0x32,1
; 486: 
; 487:  'Pulse the buzzer
; 488: If alarm_on = True Then
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS 0x32,0
	GOTO L0050
; 489: If y >= 12 And al = True Then
	MOVLW 0x0C
	SUBWF 0x34,W
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,C
	GOTO L0051
	MOVLW 0x1F
	ANDWF STATUS,F
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS 0x32,1
	GOTO L0051
; 490: PORTC.1 = 0
	BCF 0x07,1
; 491: Endif
L0051:	MOVLW 0x1F
	ANDWF STATUS,F
; 492: If y < 12 And al = True Then
	MOVLW 0x0C
	SUBWF 0x34,W
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSC STATUS,C
	GOTO L0052
	MOVLW 0x1F
	ANDWF STATUS,F
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS 0x32,1
	GOTO L0052
; 493: PORTC.1 = 1
	BSF 0x07,1
; 494: Endif
L0052:	MOVLW 0x1F
	ANDWF STATUS,F
; 495: 
; 496: If y < 15 Then
	MOVLW 0x0F
	SUBWF 0x34,W
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSC STATUS,C
	GOTO L0053
; 497: y = y + 1
	MOVF 0x34,W
	ADDLW 0x01
	MOVWF 0x34
; 498: Else
	BSF PCLATH,3
	BCF PCLATH,4
	GOTO L0054
L0053:	MOVLW 0x1F
	ANDWF STATUS,F
; 499: y = 0
	CLRF 0x34
; 500: Endif
L0054:	MOVLW 0x1F
	ANDWF STATUS,F
; 501: Endif
L0050:	MOVLW 0x1F
	ANDWF STATUS,F
; 502: If al = False Then PORTC.1 = 0 'ensure alarm always turns off
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSC 0x32,1
	GOTO L0055
	BCF 0x07,1
L0055:	MOVLW 0x1F
	ANDWF STATUS,F
; 503: If alarm_on = False Then PORTC.1 = 0
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSC 0x32,0
	GOTO L0056
	BCF 0x07,1
L0056:	MOVLW 0x1F
	ANDWF STATUS,F
; 504: 
; 505: 
; 506:  'Build alarm Byte
; 507: alarm_byte.0 = Not charge
	BTFSS 0x30,3
	BSF 0x40,0
	BTFSC 0x30,3
	BCF 0x40,0
; 508: alarm_byte.1 = Not discharge
	BTFSS 0x30,4
	BSF 0x40,1
	BTFSC 0x30,4
	BCF 0x40,1
; 509: alarm_byte.2 = Not trickle
	BTFSS 0x30,5
	BSF 0x40,2
	BTFSC 0x30,5
	BCF 0x40,2
; 510: alarm_byte.3 = Not out_ctrl 'battery < 11.8v
	BTFSS 0x32,3
	BSF 0x40,3
	BTFSC 0x32,3
	BCF 0x40,3
; 511: alarm_byte.4 = Not nobat
	BTFSS 0x30,2
	BSF 0x40,4
	BTFSC 0x30,2
	BCF 0x40,4
; 512: If top_red = 1 Or ctr_red = 1 Then alarm_byte.5 = 1 'psu failure
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS 0x30,7
	GOTO L0059
	BSF PCLATH,3
	BCF PCLATH,4
	GOTO L0058
L0059:
	MOVLW 0x1F
	ANDWF STATUS,F
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS 0x31,1
	GOTO L0057
L0058:
	BSF 0x40,5
L0057:	MOVLW 0x1F
	ANDWF STATUS,F
; 513: alarm_byte.6 = bot_red 'battery < 10V
	BTFSC 0x31,3
	BSF 0x40,6
	BTFSS 0x31,3
	BCF 0x40,6
; 514: alarm_byte.7 = 0 'must be zero to avoid confusion with start byte (hFF)
	BCF 0x40,7
; 515: Return
	RETURN
; 516: 
; 517: time_on:  'Timer for LED display
L0006:
; 518: 
; 519: If PORTA.3 = 0 Then 'Button pressed
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSC 0x05,3
	GOTO L0060
; 520: tim = 65535 'Loop counter 2min
	MOVLW 0xFF
	MOVWF 0x36
	MOVLW 0xFF
	MOVWF 0x37
; 521: leds_blanked = False 'Disable LED display
	BCF 0x31,4
; 522: If al = True Then
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS 0x32,1
	GOTO L0061
; 523: alarm_on = False
	BCF 0x32,0
; 524: Endif
L0061:	MOVLW 0x1F
	ANDWF STATUS,F
; 525: 
; 526: Endif
L0060:	MOVLW 0x1F
	ANDWF STATUS,F
; 527: 
; 528: tim = tim - 1
	MOVLW 0x01
	SUBWF 0x36,W
	MOVWF 0x36
	MOVLW 0x00
	BTFSS STATUS,C
	ADDLW 0x01
	SUBWF 0x37,W
	MOVWF 0x37
; 529: If tim = 0 Then
	MOVF 0x36,W
	MOVWF R0L
	MOVF 0x37,W
	MOVWF R0H
	CLRF R1H
	MOVLW 0x00
	BCF PCLATH,3
	BCF PCLATH,4
	CALL C001
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,Z
	GOTO L0062
; 530: leds_blanked = True
	BSF 0x31,4
; 531: Endif
L0062:	MOVLW 0x1F
	ANDWF STATUS,F
; 532: 
; 533: Return
	RETURN
; 534: 
; 535: 
; 536: 
; 537: led_test:  'Start-up Display
L0007:
; 538: ASM:        clrwdt
	       clrwdt
; 539: For i = 1 To 10
	MOVLW 0x01
	MOVWF 0x35
L0063:
	MOVF 0x35,W
	SUBLW 0x0A
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,C
	GOTO L0064
; 540: PORTA.5 = 1 'Red
	BSF 0x05,5
; 541: WaitMs 20
	MOVLW 0x14
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 542: PORTA.5 = 0
	BCF 0x05,5
; 543: Next i
	MOVLW 0x01
	ADDWF 0x35,F
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,C
	GOTO L0063
L0064:	MOVLW 0x1F
	ANDWF STATUS,F
; 544: ASM:        clrwdt
	       clrwdt
; 545: For i = 1 To 10
	MOVLW 0x01
	MOVWF 0x35
L0065:
	MOVF 0x35,W
	SUBLW 0x0A
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,C
	GOTO L0066
; 546: PORTC.4 = 1 'Green
	BSF 0x07,4
; 547: WaitMs 20
	MOVLW 0x14
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 548: PORTC.4 = 0
	BCF 0x07,4
; 549: Next i
	MOVLW 0x01
	ADDWF 0x35,F
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,C
	GOTO L0065
L0066:	MOVLW 0x1F
	ANDWF STATUS,F
; 550: ASM:        clrwdt
	       clrwdt
; 551: For i = 1 To 10
	MOVLW 0x01
	MOVWF 0x35
L0067:
	MOVF 0x35,W
	SUBLW 0x0A
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,C
	GOTO L0068
; 552: PORTB.6 = 1 'Green
	BSF 0x06,6
; 553: WaitMs 20
	MOVLW 0x14
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 554: PORTB.6 = 0
	BCF 0x06,6
; 555: Next i
	MOVLW 0x01
	ADDWF 0x35,F
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,C
	GOTO L0067
L0068:	MOVLW 0x1F
	ANDWF STATUS,F
; 556:  'ASM:        clrwdt
; 557: For i = 1 To 10
	MOVLW 0x01
	MOVWF 0x35
L0069:
	MOVF 0x35,W
	SUBLW 0x0A
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,C
	GOTO L0070
; 558: PORTC.2 = 1 'Red
	BSF 0x07,2
; 559: WaitMs 20
	MOVLW 0x14
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 560: PORTC.2 = 0
	BCF 0x07,2
; 561: Next i
	MOVLW 0x01
	ADDWF 0x35,F
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,C
	GOTO L0069
L0070:	MOVLW 0x1F
	ANDWF STATUS,F
; 562: ASM:        clrwdt
	       clrwdt
; 563: For i = 1 To 10
	MOVLW 0x01
	MOVWF 0x35
L0071:
	MOVF 0x35,W
	SUBLW 0x0A
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,C
	GOTO L0072
; 564: PORTB.4 = 1 'Red
	BSF 0x06,4
; 565: WaitMs 20
	MOVLW 0x14
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 566: PORTB.4 = 0
	BCF 0x06,4
; 567: Next i
	MOVLW 0x01
	ADDWF 0x35,F
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,C
	GOTO L0071
L0072:	MOVLW 0x1F
	ANDWF STATUS,F
; 568: ASM:        clrwdt
	       clrwdt
; 569: For i = 1 To 10
	MOVLW 0x01
	MOVWF 0x35
L0073:
	MOVF 0x35,W
	SUBLW 0x0A
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,C
	GOTO L0074
; 570: PORTC.0 = 1 'Green
	BSF 0x07,0
; 571: WaitMs 20
	MOVLW 0x14
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 572: PORTC.0 = 0
	BCF 0x07,0
; 573: Next i
	MOVLW 0x01
	ADDWF 0x35,F
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,C
	GOTO L0073
L0074:	MOVLW 0x1F
	ANDWF STATUS,F
; 574: ASM:        clrwdt
	       clrwdt
; 575: For i = 1 To 2
	MOVLW 0x01
	MOVWF 0x35
L0075:
	MOVF 0x35,W
	SUBLW 0x02
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,C
	GOTO L0076
; 576: PORTA.5 = 1
	BSF 0x05,5
; 577: PORTC.4 = 1
	BSF 0x07,4
; 578: PORTB.6 = 1
	BSF 0x06,6
; 579: PORTC.2 = 1
	BSF 0x07,2
; 580: PORTB.4 = 1
	BSF 0x06,4
; 581: PORTC.0 = 1
	BSF 0x07,0
; 582: PORTC.1 = 1
	BSF 0x07,1
; 583: WaitMs 200
	MOVLW 0xC8
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 584: ASM:        clrwdt
	       clrwdt
; 585: PORTA.5 = 0
	BCF 0x05,5
; 586: PORTC.4 = 0
	BCF 0x07,4
; 587: PORTB.6 = 0
	BCF 0x06,6
; 588: PORTC.2 = 0
	BCF 0x07,2
; 589: PORTB.4 = 0
	BCF 0x06,4
; 590: PORTC.0 = 0
	BCF 0x07,0
; 591: PORTC.1 = 0
	BCF 0x07,1
; 592: WaitMs 200
	MOVLW 0xC8
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 593: ASM:        clrwdt
	       clrwdt
; 594: Next i
	MOVLW 0x01
	ADDWF 0x35,F
	BSF PCLATH,3
	BCF PCLATH,4
	BTFSS STATUS,C
	GOTO L0075
L0076:	MOVLW 0x1F
	ANDWF STATUS,F
; 595: ASM:        clrwdt
	       clrwdt
; 596: WaitMs 200
	MOVLW 0xC8
	MOVWF R0L
	CLRF R0H
	BCF PCLATH,3
	BCF PCLATH,4
	CALL W001
; 597: ASM:        clrwdt
	       clrwdt
; 598: Return
	RETURN
; 599: 
; 600: 
; 601: 
; End of program
	BSF PCLATH,3
	BCF PCLATH,4
L0077:	GOTO L0077
; Configuration word settings
	ORG 0x2007
	DW 0x330C
; End of listing
	END
